# HC-SR04 - ‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á Ultrasonic

!!! info "‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå"
    ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô 5V ‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏ö‡∏≠‡∏£‡πå‡∏î 3.3V ‡∏Ñ‡∏ß‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á **[‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô](https://ghostmicro.github.io/micro-electronic/circuit_protection/)** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ó‡∏£‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå

![HC-SR04 Sensor](../assets/images/ultrasonic.jpg)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

HC-SR04 ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å (‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏™‡∏π‡∏á) ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏ ‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏∞‡∏¢‡∏∞ 2 ‡∏ã‡∏°. ‡∏ñ‡∏∂‡∏á 400 ‡∏ã‡∏°.

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ
- **‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏ü:** 5V DC
- **‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:** 15mA
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ô:** 40Hz
- **‡∏£‡∏∞‡∏¢‡∏∞‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ:** 2 - 400 ‡∏ã‡∏°.
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥:** ¬±3 ‡∏°‡∏°.
- **‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î:** 15 ‡∏≠‡∏á‡∏®‡∏≤

## üîå ‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏≤‡∏¢

### ‡∏û‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
1. **VCC:** 5V
2. **Trig (Trigger):** ‡∏™‡πà‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á
3. **Echo:** ‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô
4. **GND:** Ground

=== "Arduino"
    ```
    HC-SR04          Arduino
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    VCC        ‚Üí      5V
    Trig       ‚Üí      Digital Pin 9
    Echo       ‚Üí      Digital Pin 10
    GND        ‚Üí      GND
    ```

=== "ESP32"
    ```
    HC-SR04          ESP32
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    VCC        ‚Üí      5V (‡∏´‡∏£‡∏∑‡∏≠ VIN ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ USB)
    Trig       ‚Üí      GPIO 5
    Echo       ‚Üí      GPIO 18
    GND        ‚Üí      GND
    
    * ‡∏Ñ‡∏≥‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: Echo ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ô 5V ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ 
    ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ Voltage Divider ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 3.3V ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ESP32
    ```

=== "STM32"
    ```
    HC-SR04          STM32
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    VCC        ‚Üí      5V
    Trig       ‚Üí      PA1
    Echo       ‚Üí      PA2
    GND        ‚Üí      GND
    ```

## üíª ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

### Arduino

```cpp
const int trigPin = 9;
const int echoPin = 10;

void setup() {
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);
  Serial.begin(9600);
}

void loop() {
  // Clear the trigPin
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  
  // ‡∏™‡πà‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ 10 microseconds
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);
  
  // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ (microseconds)
  long duration = pulseIn(echoPin, HIGH);
  
  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (cm)
  // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏™‡∏µ‡∏¢‡∏á = 340 m/s = 0.034 cm/us
  // ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á = (‡πÄ‡∏ß‡∏•‡∏≤ * ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß) / 2 (‡πÑ‡∏õ-‡∏Å‡∏•‡∏±‡∏ö)
  int distance = duration * 0.034 / 2;
  
  Serial.print("Distance: ");
  Serial.print(distance);
  Serial.println(" cm");
  
  delay(100);
}
```

### Library ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (NewPing)

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Arduino ‡πÅ‡∏•‡∏∞ ESP32 ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Library **NewPing** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤

```cpp
#include <NewPing.h>

#define TRIGGER_PIN  5
#define ECHO_PIN     18
#define MAX_DISTANCE 400

NewPing sonar(TRIGGER_PIN, ECHO_PIN, MAX_DISTANCE);

void setup() {
  Serial.begin(115200);
}

void loop() {
  delay(50);
  Serial.print("Distance: ");
  Serial.print(sonar.ping_cm());
  Serial.println("cm");
}
```

## üõ†Ô∏è ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ DIY

### 1. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏î‡∏¥‡∏à‡∏¥‡∏ï‡∏≠‡∏•
‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏ï‡∏π ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏•‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ñ‡∏ô

### 2. ‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå‡∏´‡∏•‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏µ‡∏î‡∏Ç‡∏ß‡∏≤‡∏á
‡πÉ‡∏ä‡πâ HC-SR04 ‡∏ï‡∏¥‡∏î‡∏ö‡∏ô Servo ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ô‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤ ‡∏ï‡∏£‡∏ß‡∏à‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡πÑ‡∏´‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∞‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠

### 3. ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå
‡πÉ‡∏ä‡πâ Buzzer ‡∏™‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏µ‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

!!! warning "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡∏õ 3.3V"
    ‡∏û‡∏¥‡∏ô **Echo** ‡∏Ç‡∏≠‡∏á HC-SR04 ‡∏à‡∏∞‡∏™‡πà‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ô‡∏ó‡∏µ‡πà **5V** ‡πÄ‡∏™‡∏°‡∏≠ ‡∏´‡∏≤‡∏Å‡∏ô‡∏≥‡πÑ‡∏õ‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö ESP32 ‡∏´‡∏£‡∏∑‡∏≠ STM32 ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏ß‡∏á‡∏à‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô (Voltage Divider) ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Bi-directional Logic Level Shifter

!!! tip "‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏"
    ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡∏ô‡∏∏‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏î‡∏ã‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏ü‡∏≠‡∏á‡∏ô‡πâ‡∏≥ ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
